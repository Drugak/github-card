<polymer-element name="github-card" attributes="user">
  <template>
    <link rel="stylesheet" href="github-card.css">

    <article id="user" class="user spinner">
      <dl id="data" class="user-data" hidden>
        <dt>Avatar:</dt>
        <dd class="user-avatar">
          <img id="avatar" src="">
        </dd>

        <dt>Fullname:</dt>
        <dd id="name" class="user-name"></dd>

        <dt>Account:</dt>
        <dd class="user-account">
          <a id="account"></a>
        </dd>
      </dl>
      <dl id="stats" class="user-stats" hidden>
        <dt>Repos</dt>
        <dd class="user-repos" data-stats="repos">
          <a id="repos"></a>
        </dd>

        <dt>Followers</dt>
        <dd class="user-followers" data-stats="followers">
          <a id="followers"></a>
        </dd>
      </dl>
    </article>
  </template>

  <script>

    var url = 'https://api.github.com/users/';

    Polymer('github-card', {
      'user': '',

      'getUser': function getJSON() {
        var that = this,
            xhr = new XMLHttpRequest();

        xhr.open('GET', url + this.user);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === xhr.DONE) {
            status = xhr.status;

            if ((status >= 200 && status < 300) || status === 304 || status === 0) {
              response = JSON.parse(xhr.response || xhr.responseText);
              that.fillUser(response);
            }
          }
        };

        xhr.send();
      },

      'fillUser': function fillUser(user) {
        this.$.user.classList.remove('spinner');
        this.$.data.removeAttribute('hidden');
        this.$.stats.removeAttribute('hidden');
        this.$.account.textContent = this.getAttribute('user');
        this.$.account.href = user.html_url;
        this.$.name.textContent = user.name;
        this.$.avatar.src = user.avatar_url;
        this.$.repos.textContent = user.public_repos;
        this.$.repos.href = user.html_url.concat('?tab=repositories');
        this.$.followers.textContent = user.followers;
        this.$.followers.href = user.html_url.concat('/followers');
      },

      'attributeChanged': function() {
        this.getUser();
      }
    });
  </script>
</polymer>